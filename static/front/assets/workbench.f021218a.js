import{r as u,a as s,A as re,g as P,j as g,az as ct,F as G,b as oe,u as le,a9 as z,aa as Z,n as Be,ay as ut,O as ht}from"./index.bb86fbbf.js";import{A as me}from"./index.20f4d44c.js";import{M as He}from"./index.bb824a09.js";import{B as Ve}from"./button.aa0bb50b.js";import{i as se}from"./use-immer.module.c8467ba8.js";import{I as xe}from"./index.da25c8fe.js";import{d as ge}from"./dayjs.min.bdeb7890.js";import{d as dt}from"./duration.bb39ae3f.js";import{m as Ue,i as qe,a as pt}from"./utils.c9742588.js";import{R as ft}from"./index.682dcb84.js";import{W as ce}from"./workbenchContext.3d2abc29.js";import{_ as mt,I as gt,e as Ge}from"./index.ef4e31c1.js";import{u as vt}from"./index.esm.ac9005b0.js";import{m as wt,e as bt,D as yt,f as At,a as ze,P as Ke,u as De,b as _t,c as xt,s as ee,M as Et,d as Ct,g as St,h as Je,A as q,E as Nt,i as kt,j as Ie}from"./useCurrentEntity.3cf925e7.js";/* empty css               */import{P as Ft}from"./index.86464724.js";import{I as Ce}from"./index.837f2673.js";import"./index.61964446.js";import{D as ve,M as we}from"./index.c0722274.js";import"./iconUtil.02bc4596.js";import{S as Re}from"./index.4c04c22e.js";/* empty css               */import{P as Se}from"./index.29ffa237.js";import{M as Oe}from"./MoreOutlined.b21a3a37.js";import{D as Bt}from"./DeleteOutlined.71bf1760.js";import{P as zt}from"./PlusOutlined.c73517e2.js";import{T as Dt}from"./Tree.4ceb5bc3.js";import{T as ne}from"./styleChecker.d685456c.js";import{o as It,p as Ze,q as Rt,r as Ot}from"./_baseIsEqual.08bd8828.js";import{I as ae}from"./index.34a54fb6.js";import"./Sider.d20f3d2a.js";import"./RightOutlined.93d63f13.js";import"./omit.fd69d8d2.js";import"./Portal.a4c68d61.js";import"./type.4482a080.js";import"./DialogWrap.ab5d7a46.js";import"./PortalWrapper.eb4c9ec4.js";import"./pickAttrs.38f17648.js";import"./context.24d2ae58.js";import"./EyeOutlined.7a3a19f7.js";import"./css.7dd30b7b.js";import"./index.80acc5c7.js";import"./identity.bf2ac13f.js";import"./index.9ea41163.js";import"./index.2f0a4123.js";import"./row.b57345b2.js";import"./responsiveObserve.57a0a6d3.js";import"./index.4f67b986.js";import"./statusUtils.077f8a48.js";import"./index.445b6a21.js";import"./source.c7b92d0a.js";import"./tslib.es6.d40f4976.js";import"./printer.6dfbd086.js";import"./SearchOutlined.7a88f9ff.js";import"./Dropdown.6fe64b76.js";import"./Overflow.7a0e3cac.js";import"./conductUtil.03254829.js";import"./SearchOutlined.5704e58e.js";var Mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M624 706.3h-74.1V464c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v242.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.7a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-download",theme:"outlined"};const Tt=Mt;var Xe=function(n,e){return s(re,{...P(P({},n),{},{ref:e,icon:Tt})})};Xe.displayName="CloudDownloadOutlined";const Wt=u.exports.forwardRef(Xe);var $t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M301.3 496.7c-23.8 0-40.2-10.5-41.6-26.9H205c.9 43.4 36.9 70.3 93.9 70.3 59.1 0 95-28.4 95-75.5 0-35.8-20-55.9-64.5-64.5l-29.1-5.6c-23.8-4.7-33.8-11.9-33.8-24.2 0-15 13.3-24.5 33.4-24.5 20.1 0 35.3 11.1 36.6 27h53c-.9-41.7-37.5-70.3-90.3-70.3-54.4 0-89.7 28.9-89.7 73 0 35.5 21.2 58 62.5 65.8l29.7 5.9c25.8 5.2 35.6 11.9 35.6 24.4.1 14.7-14.5 25.1-36 25.1z"}},{tag:"path",attrs:{d:"M928 140H96c-17.7 0-32 14.3-32 32v496c0 17.7 14.3 32 32 32h380v112H304c-8.8 0-16 7.2-16 16v48c0 4.4 3.6 8 8 8h432c4.4 0 8-3.6 8-8v-48c0-8.8-7.2-16-16-16H548V700h380c17.7 0 32-14.3 32-32V172c0-17.7-14.3-32-32-32zm-40 488H136V212h752v416z"}},{tag:"path",attrs:{d:"M828.5 486.7h-95.8V308.5h-57.4V534h153.2zm-298.6 53.4c14.1 0 27.2-2 39.1-5.8l13.3 20.3h53.3L607.9 511c21.1-20 33-51.1 33-89.8 0-73.3-43.3-118.8-110.9-118.8s-111.2 45.3-111.2 118.8c-.1 73.7 43 118.9 111.1 118.9zm0-190c31.6 0 52.7 27.7 52.7 71.1 0 16.7-3.6 30.6-10 40.5l-5.2-6.9h-48.8L542 491c-3.9.9-8 1.4-12.2 1.4-31.7 0-52.8-27.5-52.8-71.2.1-43.6 21.2-71.1 52.9-71.1z"}}]},name:"console-sql",theme:"outlined"};const Lt=$t;var Qe=function(n,e){return s(re,{...P(P({},n),{},{ref:e,icon:Lt})})};Qe.displayName="ConsoleSqlOutlined";const Pt=u.exports.forwardRef(Qe);var Yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"};const jt=Yt;var et=function(n,e){return s(re,{...P(P({},n),{},{ref:e,icon:jt})})};et.displayName="FormOutlined";const Ht=u.exports.forwardRef(et);var Vt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"}}]},name:"github",theme:"outlined"};const Ut=Vt;var tt=function(n,e){return s(re,{...P(P({},n),{},{ref:e,icon:Ut})})};tt.displayName="GithubOutlined";const qt=u.exports.forwardRef(tt);var Gt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"};const Kt=Gt;var it=function(n,e){return s(re,{...P(P({},n),{},{ref:e,icon:Kt})})};it.displayName="ShareAltOutlined";const Jt=u.exports.forwardRef(it);ge.extend(dt);function Me(t){const n=ge.duration(ge().diff(ge(t),"seconds"),"seconds");return n.$d.days>0?`${n.$d.days}\u5929\u524D`:n.$d.hours>0?`${n.$d.hours}\u5C0F\u65F6\u524D`:n.$d.minutes>0?`${n.$d.minutes}\u5206\u949F\u524D`:n.$d.seconds>0?`${n.$d.seconds}\u79D2\u524D`:"\u521A\u521A"}const Zt="_info_19t86_9",Xt="_gitIcon_19t86_17",Qt="_errLabel_19t86_23",ei="_statusLabel_19t86_26",j={"status-bar":"_status-bar_19t86_1",info:Zt,gitIcon:Xt,errLabel:Qt,statusLabel:ei},ti=({className:t,env:n,version:e,startTime:i,errorInfo:a,engineStatus:r,hookStatus:l,toggleWindow:o})=>{var f,h;const[c,p]=u.exports.useState();return u.exports.useEffect(()=>{if(!i)return;p(Me(i));const w=setInterval(()=>{p(Me(i))},6e4);return()=>{clearInterval(w)}},[i]),s("div",{className:t,children:s("div",{className:j["status-bar"],children:g("span",{className:j.info,children:[s("span",{className:j.gitIcon}),s("span",{className:"mr-12",children:"CONNECT GIT (BETA)"}),s("span",{className:j["info-env"],children:s("span",{children:n})}),g("span",{className:j["info-version"],children:[s("span",{children:"FB: "}),s("span",{className:"ml-2",children:e})]}),g("span",{onClick:o,className:"cursor-pointer flex items-center",children:[g("span",{className:j.errLabel,children:[s(xe,{height:13,width:13,src:"/assets/workbench/footer-error.png",alt:"\u9519\u8BEF",preview:!1}),s("span",{className:"ml-2",children:(f=a==null?void 0:a.errTotal)!=null?f:0})]}),g("span",{className:j.errLabel,style:{marginLeft:8},children:[s(xe,{height:13,width:13,src:"/assets/workbench/footer-warning.png",alt:"\u8B66\u544A",preview:!1}),s("span",{className:"ml-2",children:(h=a==null?void 0:a.warnTotal)!=null?h:0})]})]}),s("span",{className:"ml-18",children:"\u5F15\u64CE\u72B6\u6001\uFF1A"}),g("span",{className:j.errLabel,children:[s("div",{className:"h-3px w-3px rounded-3px bg-[#50C772]"}),s("span",{className:"ml-1 text-[#50C772]",children:r})]}),s("span",{className:"ml-4.5",children:"\u94A9\u5B50\u72B6\u6001\uFF1A"}),g("span",{className:j.errLabel,children:[s("div",{className:"h-3px w-3px rounded-3px bg-[#50C772]"}),s("span",{className:"ml-1 text-[#50C772]",children:l})]}),g("span",{className:"ml-4.5",children:["\u7F16\u8BD1\u65F6\u95F4\uFF1A",c]})]})})})},ii=ti;var ni=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},t(n,e)};return function(n,e){t(n,e);function i(){this.constructor=n}n.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),F=globalThis&&globalThis.__assign||function(){return F=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},F.apply(this,arguments)},Te={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},We={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},ue={width:"20px",height:"20px",position:"absolute"},si={top:F(F({},Te),{top:"-5px"}),right:F(F({},We),{left:void 0,right:"-5px"}),bottom:F(F({},Te),{top:void 0,bottom:"-5px"}),left:F(F({},We),{left:"-5px"}),topRight:F(F({},ue),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:F(F({},ue),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:F(F({},ue),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:F(F({},ue),{left:"-10px",top:"-10px",cursor:"nw-resize"})},ai=function(t){ni(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.onMouseDown=function(i){e.props.onResizeStart(i,e.props.direction)},e.onTouchStart=function(i){e.props.onResizeStart(i,e.props.direction)},e}return n.prototype.render=function(){return s("div",{className:this.props.className||"",style:F(F({position:"absolute",userSelect:"none"},si[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,children:this.props.children})},n}(u.exports.PureComponent),ri=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},t(n,e)};return function(n,e){t(n,e);function i(){this.constructor=n}n.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),L=globalThis&&globalThis.__assign||function(){return L=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},L.apply(this,arguments)},oi={width:"auto",height:"auto"},he=function(t,n,e){return Math.max(Math.min(t,e),n)},$e=function(t,n){return Math.round(t/n)*n},ie=function(t,n){return new RegExp(t,"i").test(n)},de=function(t){return Boolean(t.touches&&t.touches.length)},li=function(t){return Boolean((t.clientX||t.clientX===0)&&(t.clientY||t.clientY===0))},Le=function(t,n,e){e===void 0&&(e=0);var i=n.reduce(function(r,l,o){return Math.abs(l-t)<Math.abs(n[r]-t)?o:r},0),a=Math.abs(n[i]-t);return e===0||a<e?n[i]:t},ye=function(t){return t=t.toString(),t==="auto"||t.endsWith("px")||t.endsWith("%")||t.endsWith("vh")||t.endsWith("vw")||t.endsWith("vmax")||t.endsWith("vmin")?t:t+"px"},pe=function(t,n,e,i){if(t&&typeof t=="string"){if(t.endsWith("px"))return Number(t.replace("px",""));if(t.endsWith("%")){var a=Number(t.replace("%",""))/100;return n*a}if(t.endsWith("vw")){var a=Number(t.replace("vw",""))/100;return e*a}if(t.endsWith("vh")){var a=Number(t.replace("vh",""))/100;return i*a}}return t},ci=function(t,n,e,i,a,r,l){return i=pe(i,t.width,n,e),a=pe(a,t.height,n,e),r=pe(r,t.width,n,e),l=pe(l,t.height,n,e),{maxWidth:typeof i>"u"?void 0:Number(i),maxHeight:typeof a>"u"?void 0:Number(a),minWidth:typeof r>"u"?void 0:Number(r),minHeight:typeof l>"u"?void 0:Number(l)}},ui=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],Pe="__resizable_base__",hi=function(t){ri(n,t);function n(e){var i=t.call(this,e)||this;return i.ratio=1,i.resizable=null,i.parentLeft=0,i.parentTop=0,i.resizableLeft=0,i.resizableRight=0,i.resizableTop=0,i.resizableBottom=0,i.targetLeft=0,i.targetTop=0,i.appendBase=function(){if(!i.resizable||!i.window)return null;var a=i.parentNode;if(!a)return null;var r=i.window.document.createElement("div");return r.style.width="100%",r.style.height="100%",r.style.position="absolute",r.style.transform="scale(0, 0)",r.style.left="0",r.style.flex="0 0 100%",r.classList?r.classList.add(Pe):r.className+=Pe,a.appendChild(r),r},i.removeBase=function(a){var r=i.parentNode;!r||r.removeChild(a)},i.ref=function(a){a&&(i.resizable=a)},i.state={isResizing:!1,width:typeof(i.propsSize&&i.propsSize.width)>"u"?"auto":i.propsSize&&i.propsSize.width,height:typeof(i.propsSize&&i.propsSize.height)>"u"?"auto":i.propsSize&&i.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},i.onResizeStart=i.onResizeStart.bind(i),i.onMouseMove=i.onMouseMove.bind(i),i.onMouseUp=i.onMouseUp.bind(i),i}return Object.defineProperty(n.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||oi},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){var e=0,i=0;if(this.resizable&&this.window){var a=this.resizable.offsetWidth,r=this.resizable.offsetHeight,l=this.resizable.style.position;l!=="relative"&&(this.resizable.style.position="relative"),e=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:a,i=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:r,this.resizable.style.position=l}return{width:e,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sizeStyle",{get:function(){var e=this,i=this.props.size,a=function(o){if(typeof e.state[o]>"u"||e.state[o]==="auto")return"auto";if(e.propsSize&&e.propsSize[o]&&e.propsSize[o].toString().endsWith("%")){if(e.state[o].toString().endsWith("%"))return e.state[o].toString();var c=e.getParentSize(),p=Number(e.state[o].toString().replace("px","")),f=p/c[o]*100;return f+"%"}return ye(e.state[o])},r=i&&typeof i.width<"u"&&!this.state.isResizing?ye(i.width):a("width"),l=i&&typeof i.height<"u"&&!this.state.isResizing?ye(i.height):a("height");return{width:r,height:l}},enumerable:!1,configurable:!0}),n.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=this.appendBase();if(!e)return{width:0,height:0};var i=!1,a=this.parentNode.style.flexWrap;a!=="wrap"&&(i=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%",e.style.minHeight="100%";var r={width:e.offsetWidth,height:e.offsetHeight};return i&&(this.parentNode.style.flexWrap=a),this.removeBase(e),r},n.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},n.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},n.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:e.flexBasis!=="auto"?e.flexBasis:void 0})}},n.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},n.prototype.createSizeForCssProperty=function(e,i){var a=this.propsSize&&this.propsSize[i];return this.state[i]==="auto"&&this.state.original[i]===e&&(typeof a>"u"||a==="auto")?"auto":e},n.prototype.calculateNewMaxFromBoundary=function(e,i){var a=this.props.boundsByDirection,r=this.state.direction,l=a&&ie("left",r),o=a&&ie("top",r),c,p;if(this.props.bounds==="parent"){var f=this.parentNode;f&&(c=l?this.resizableRight-this.parentLeft:f.offsetWidth+(this.parentLeft-this.resizableLeft),p=o?this.resizableBottom-this.parentTop:f.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(c=l?this.resizableRight:this.window.innerWidth-this.resizableLeft,p=o?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(c=l?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),p=o?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return c&&Number.isFinite(c)&&(e=e&&e<c?e:c),p&&Number.isFinite(p)&&(i=i&&i<p?i:p),{maxWidth:e,maxHeight:i}},n.prototype.calculateNewSizeFromDirection=function(e,i){var a=this.props.scale||1,r=this.props.resizeRatio||1,l=this.state,o=l.direction,c=l.original,p=this.props,f=p.lockAspectRatio,h=p.lockAspectRatioExtraHeight,w=p.lockAspectRatioExtraWidth,y=c.width,A=c.height,E=h||0,N=w||0;return ie("right",o)&&(y=c.width+(e-c.x)*r/a,f&&(A=(y-N)/this.ratio+E)),ie("left",o)&&(y=c.width-(e-c.x)*r/a,f&&(A=(y-N)/this.ratio+E)),ie("bottom",o)&&(A=c.height+(i-c.y)*r/a,f&&(y=(A-E)*this.ratio+N)),ie("top",o)&&(A=c.height-(i-c.y)*r/a,f&&(y=(A-E)*this.ratio+N)),{newWidth:y,newHeight:A}},n.prototype.calculateNewSizeFromAspectRatio=function(e,i,a,r){var l=this.props,o=l.lockAspectRatio,c=l.lockAspectRatioExtraHeight,p=l.lockAspectRatioExtraWidth,f=typeof r.width>"u"?10:r.width,h=typeof a.width>"u"||a.width<0?e:a.width,w=typeof r.height>"u"?10:r.height,y=typeof a.height>"u"||a.height<0?i:a.height,A=c||0,E=p||0;if(o){var N=(w-A)*this.ratio+E,D=(y-A)*this.ratio+E,T=(f-E)/this.ratio+A,x=(h-E)/this.ratio+A,d=Math.max(f,N),v=Math.min(h,D),b=Math.max(w,T),_=Math.min(y,x);e=he(e,d,v),i=he(i,b,_)}else e=he(e,f,h),i=he(i,w,y);return{newWidth:e,newHeight:i}},n.prototype.setBoundingClientRect=function(){if(this.props.bounds==="parent"){var e=this.parentNode;if(e){var i=e.getBoundingClientRect();this.parentLeft=i.left,this.parentTop=i.top}}if(this.props.bounds&&typeof this.props.bounds!="string"){var a=this.props.bounds.getBoundingClientRect();this.targetLeft=a.left,this.targetTop=a.top}if(this.resizable){var r=this.resizable.getBoundingClientRect(),l=r.left,o=r.top,c=r.right,p=r.bottom;this.resizableLeft=l,this.resizableRight=c,this.resizableTop=o,this.resizableBottom=p}},n.prototype.onResizeStart=function(e,i){if(!(!this.resizable||!this.window)){var a=0,r=0;if(e.nativeEvent&&li(e.nativeEvent)?(a=e.nativeEvent.clientX,r=e.nativeEvent.clientY):e.nativeEvent&&de(e.nativeEvent)&&(a=e.nativeEvent.touches[0].clientX,r=e.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var l=this.props.onResizeStart(e,i,this.resizable);if(l===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var o,c=this.window.getComputedStyle(this.resizable);if(c.flexBasis!=="auto"){var p=this.parentNode;if(p){var f=this.window.getComputedStyle(p).flexDirection;this.flexDir=f.startsWith("row")?"row":"column",o=c.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var h={original:{x:a,y:r,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:L(L({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:i,flexBasis:o};this.setState(h)}},n.prototype.onMouseMove=function(e){var i=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&de(e))try{e.preventDefault(),e.stopPropagation()}catch{}var a=this.props,r=a.maxWidth,l=a.maxHeight,o=a.minWidth,c=a.minHeight,p=de(e)?e.touches[0].clientX:e.clientX,f=de(e)?e.touches[0].clientY:e.clientY,h=this.state,w=h.direction,y=h.original,A=h.width,E=h.height,N=this.getParentSize(),D=ci(N,this.window.innerWidth,this.window.innerHeight,r,l,o,c);r=D.maxWidth,l=D.maxHeight,o=D.minWidth,c=D.minHeight;var T=this.calculateNewSizeFromDirection(p,f),x=T.newHeight,d=T.newWidth,v=this.calculateNewMaxFromBoundary(r,l);this.props.snap&&this.props.snap.x&&(d=Le(d,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(x=Le(x,this.props.snap.y,this.props.snapGap));var b=this.calculateNewSizeFromAspectRatio(d,x,{width:v.maxWidth,height:v.maxHeight},{width:o,height:c});if(d=b.newWidth,x=b.newHeight,this.props.grid){var _=$e(d,this.props.grid[0]),R=$e(x,this.props.grid[1]),k=this.props.snapGap||0;d=k===0||Math.abs(_-d)<=k?_:d,x=k===0||Math.abs(R-x)<=k?R:x}var K={width:d-y.width,height:x-y.height};if(A&&typeof A=="string"){if(A.endsWith("%")){var X=d/N.width*100;d=X+"%"}else if(A.endsWith("vw")){var J=d/this.window.innerWidth*100;d=J+"vw"}else if(A.endsWith("vh")){var Y=d/this.window.innerHeight*100;d=Y+"vh"}}if(E&&typeof E=="string"){if(E.endsWith("%")){var X=x/N.height*100;x=X+"%"}else if(E.endsWith("vw")){var J=x/this.window.innerWidth*100;x=J+"vw"}else if(E.endsWith("vh")){var Y=x/this.window.innerHeight*100;x=Y+"vh"}}var W={width:this.createSizeForCssProperty(d,"width"),height:this.createSizeForCssProperty(x,"height")};this.flexDir==="row"?W.flexBasis=W.width:this.flexDir==="column"&&(W.flexBasis=W.height),ct.exports.flushSync(function(){i.setState(W)}),this.props.onResize&&this.props.onResize(e,w,this.resizable,K)}},n.prototype.onMouseUp=function(e){var i=this.state,a=i.isResizing,r=i.direction,l=i.original;if(!(!a||!this.resizable)){var o={width:this.size.width-l.width,height:this.size.height-l.height};this.props.onResizeStop&&this.props.onResizeStop(e,r,this.resizable,o),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:L(L({},this.state.backgroundStyle),{cursor:"auto"})})}},n.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},n.prototype.renderResizer=function(){var e=this,i=this.props,a=i.enable,r=i.handleStyles,l=i.handleClasses,o=i.handleWrapperStyle,c=i.handleWrapperClass,p=i.handleComponent;if(!a)return null;var f=Object.keys(a).map(function(h){return a[h]!==!1?s(ai,{direction:h,onResizeStart:e.onResizeStart,replaceStyles:r&&r[h],className:l&&l[h],children:p&&p[h]?p[h]:null},h):null});return s("div",{className:c,style:o,children:f})},n.prototype.render=function(){var e=this,i=Object.keys(this.props).reduce(function(l,o){return ui.indexOf(o)!==-1||(l[o]=e.props[o]),l},{}),a=L(L(L({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(a.flexBasis=this.state.flexBasis);var r=this.props.as||"div";return g(r,{...L({ref:this.ref,style:a,className:this.props.className},i),children:[this.state.isResizing&&s("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]})},n.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},n}(u.exports.PureComponent);const di=({actionRef:t})=>{const[n,e]=u.exports.useState([]),i=u.exports.useRef(null);return u.exports.useEffect(()=>{var a;(a=i.current)==null||a.scrollIntoView({behavior:"smooth"})},[n]),u.exports.useEffect(()=>{t&&(t.current={appendLogs(a){e([...n,...a.map(r=>({...r,logType:r.logType||1}))])},clearLogs(){e([])},downloadLogs(){const a=new File([n.map(o=>JSON.stringify(o)).join(`
`)],"logs.txt",{type:"text/plain"}),r=document.createElement("a"),l=URL.createObjectURL(a);r.href=l,r.download=a.name,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(l)}})},[t,n]),s("div",{className:"flex flex-1 w-full overflow-hidden",children:g("div",{className:"h-full mb-0 w-10/10 overflow-auto",children:[n.map((a,r)=>g("div",{className:"text-xs leading-25px font-normal text-[#333333]",children:[s("span",{className:"mr-8",children:a.time})," ",s("span",{className:"mr-1.5",children:s("img",{src:a.logType===1?"/assets/log-core.svg":"/assets/log-hook.svg",alt:a.logType===1?"\u6838\u5FC3\u65E5\u5FD7":"\u94A9\u5B50\u65E5\u5FD7"})}),s("span",{className:"w-100 mr-1",children:a.level})," ",s("span",{children:a.msg})]},r)),s("div",{ref:i})]})})},pi=[{title:"\u7EC8\u7AEF",key:"0"},{title:"\u95EE\u9898",key:"1"}],fi=({style:t,toggleWindow:n})=>{var o;const[e,i]=u.exports.useState("0"),a=u.exports.useRef(),r=u.exports.useRef();u.exports.useEffect(()=>{const c=new AbortController,p=c.signal;async function f(){var h;if(!r.current){r.current=await fetch("/api/v1/wdg/log",{signal:p});const w=r.current.body.getReader(),y=new TextDecoder;let A=await w.read();for(;!A.done;){const E=y.decode(A.value);console.log("log stream: ",E);const N=Ue(E);(h=a.current)==null||h.appendLogs(N),A=await w.read()}console.log("Log finished")}}return f(),()=>{console.log("close fetch"),c.abort()}},[]);const l=g("div",{className:"cursor-pointer flex justify-end",children:[s("div",{onClick:()=>{var c;return(c=a.current)==null?void 0:c.clearLogs()},children:s("img",{src:"/assets/clear.png",height:20,width:20,alt:"\u6E05\u7A7A"})}),s("div",{className:"ml-4",onClick:(o=a.current)==null?void 0:o.downloadLogs,children:s("img",{src:"/assets/download.png",height:20,width:20,alt:"\u4E0B\u8F7D"})}),s("div",{className:"ml-4",onClick:n,children:s("img",{src:"/assets/close.png",height:20,width:20,alt:"\u5173\u95ED"})})]});return s("div",{className:"bg-[#fff] border-gray-500/50 min-h-80px py-5 px-7 bottom-36px z-200  absolute",style:{borderTop:"1px solid #EFEFEFFF",...t},children:g(hi,{className:"flex flex-col h-full",defaultSize:{width:"100%",height:348},minWidth:"100%",maxWidth:"100%",children:[s(ft,{tabs:pi,onTabClick:i,activeKey:e,extra:l}),e==="0"?s(di,{actionRef:a}):s(G,{})]})})},mi=fi,gi=t=>{const[n,e]=u.exports.useReducer(wt,bt.state),[i,a]=se("preview"),[r,l]=se([]),{data:o,error:c}=vt(yt,At);u.exports.useEffect(()=>{var w;l((w=o==null?void 0:o.filter(y=>y.sourceType===1))!=null?w:[])},[o,l]),u.exports.useEffect(()=>{r.length>0&&ze(r[0].id,e,r)},[r]);const p=w=>{ze(w,e,r),a("preview")},f=w=>{a((w==null?void 0:w.type)==="enum"?"editEnum":"preview"),e(De(w.id)),e(_t([]))},h=w=>{a(w.type==="model"?"editModel":"editEnum"),e(De(w.id))};return s(Ke.Provider,{value:{state:n,dispatch:e,panel:{handleToggleDesigner:h,handleClickEntity:f,handleChangeSource:p,setShowType:a,dataSources:r,showType:i}},children:t.children})},vi=gi,wi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAoCAMAAAC/1ZhiAAAA7VBMVEUAAACAhI2BhI2EiJCAhI2AhI2AhIx4foiAhI2Ag41fY2qAhI7f39+Ch4yAmZnb29vb29tiZWyCho7g4ODb29tiZGtfYmpfYmmAhY2BhYxiYmpjaGx0eH/Ky8xlZ2/c3NyAg42AhIxgY2qAhIxydX1gZGtgY2mAg41jZWutr7NhY2pfZGqBhI9hZGqdoKPe3t5iYmxgZG1fZGljY2vb29t/g4xfYmnV1ta5u76PkprOz9Cgo6mUlp2Hi5Kpq7DKysx2eoK8vb+4ubuEh455e4FnaXDR0dLExci/wMOytLiwsbOUl557f4dwcnhmaXAkd/fiAAAANHRSTlMAc1gU/PbxD+LDo3w/Mwrsx0o/Ifr38OdnRkEd/e/r2NDBvLSdkoiGgYBsY11ZVlROPTMfT6pkcAAAAWVJREFUOMvV1GV3gzAUgOEEhrTUZbW5uyYBCtTn8v9/zu7JaJEk2+c+n99zzw0StM6s3hXGWkP/N+wWNii3sY//rjWaYjoVpHYOM8NgNApCHttlVdiskZdXl3Cu50NraPKyVCUZXgSxJi1bJGfow9z8DvU71KwSgQutnT1bn7F+jUgMYQcn89Q7jO24RMaDZ6ajRJGBiEjBCjgprxn3rhpbWJWDTcY9DaXbfk62zo6L9zw9YDEqdOPFN/tV5CkMjccK6ZQtPfD0sV4/mkzC2WxMBGEyNIYpHRGpOS/bg/S3F8hTd8HACVppUBoSuecvxjpWkurwmbqKdtxmFyilQKlHFG4uEUify1eUuyhLN5Vjb1GOQ2kkfbE1lFexYQXJyapNJCgb0ApzWyXVFRBl9p0G21BKWwNi31v+3G8RpSZSKNvQxlfGx5yCQ6RScUyaYpxaSE3Hq+ttT7jexLqhYdztWWit/QAZeJg7kiUxwAAAAABJRU5ErkJggg==",bi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAdVBMVEUAAABpa3ZfY2lgY2pjaW6Ag41gYmlgY2pgY2pgY2qEhJBgYmpfYmpfYmlfYmlgYmlfYmmAhI5gYmlfYmpjZmxgY2qAg42AhIxgYmqAg4yAg41gY2lgYmqAhIxhY2phZWxhZWmAhI1gZWqAipVfYmpfYml/g4yXm/PmAAAAJXRSTlMACsy1F+/ijWVMHevH9tS8lW5tVCqog+DXxsClnJl0Rz86MhipIYttAwAAAQtJREFUOMvlklm2gyAMQCNKFZyH2nl+cf9LfJZ4VGjoBnr/gtcMEPgJojYOs0KUVfJVa0Oc+WLeClxR+bTgjBalrzmBNsLjbdCh4OtO+fJs/iHjvK6cBggAVIqG8DNbs8f1N0VB7Hpq6U7RCR20jhfjwpOOqN/I9k6I7mMEOdPiFdekJkvFVL6jTZo8VcjdojBfc/zkZovJtuloHoczsGxdTwTAE9reJvKuWGbl83jaMUu+7mM3yHo0l+odn04OI/Vqoj2wHIc30rw63WfDevVA6HeQmonZDl+SvJ2JplXjuJAnH2bNaV05NHlHbaJm9E7A0pt0NRB/iFfgOYze5TVviLiDh/7Qa/gh/gEa8zxAg7FEpgAAAABJRU5ErkJggg==",yi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAY1BMVEUAAADU1NRjZmxvcnePkZVgY2rPz9BfY2poaHTAwMOAhIxoa3FgYmpgYmlgY2nFxcbU1NRmZm+Ag427u73U1NRfYml/g4zt7e3k5eXW1te9vsCztLefoaWanKCOkJVydXtucXecDQKGAAAAFXRSTlMAzP336NDOiAvTz/rn2tjSph7Qs6d9epWLAAAAjElEQVQ4y+2T2Q6EIAxFK+A6mzMj4q7//5VaYngCG2N8cDkvNOlJSG9TuCq+XMQ3oiQ4p0jGsx+/fCIByDwrqRFzDYDn4BatYiw4Y1zEhBgIJjUsjJbED5eG19ctBtrr66rD9x05RYH9oVBKtViFTvGB7UZNlFg9N4n01/QwdDwrA0/mU0jtK/zDYRgBwgsrsPomQg4AAAAASUVORK5CYII=",Ai="_header_ylulv_1",_i="_dashboardIcon_ylulv_8",xi="_dashboardIcon2_ylulv_14",Ei="_logo_ylulv_20",Ci="_splitLine_ylulv_28",Si="_title_ylulv_33",Ni="_titleIcon_ylulv_37",ki="_headBtn_ylulv_43",Fi="_helpIcon_ylulv_55",Bi="_configIcon_ylulv_61",zi="_avatar_ylulv_68",M={header:Ai,dashboardIcon:_i,dashboardIcon2:xi,logo:Ei,splitLine:Ci,title:Si,titleIcon:Ni,headBtn:ki,helpIcon:Fi,configIcon:Bi,avatar:zi};function Di(t){const n=oe(),{pathname:e}=le(),{isFullscreen:i}=u.exports.useContext(ce),[a,r]=u.exports.useState(!1);return s(G,{children:g("div",{className:M.header,children:[s("div",{className:i?M.dashboardIcon2:M.dashboardIcon,onClick:()=>t.onToggleSider()}),s("div",{className:M.logo,onClick:()=>n("/workbench")}),s("div",{className:M.splitLine}),s("div",{className:M.title,children:"\u540E\u53F0\u7BA1\u7406\u7CFB\u7EDF"}),s("div",{className:M.titleIcon}),s("div",{className:"flex-1"}),e==="/workbench/rapi"?g(G,{children:[s(Jt,{style:{fontSize:"18px"},className:"cursor-pointer"}),s(Ft,{color:"#2A2B2CFF",content:g("div",{children:[s("a",{className:"text-[#f0f8ff]",onClick:()=>r(!1),href:"/api/v1/file/DownloadPostman",download:"Postman",children:"\u4E0B\u8F7D POSTMAN"}),s("br",{}),s("a",{className:"text-[#f0f8ff]",onClick:()=>r(!1),href:"/api/v1/file/postToSwag",download:"OpenAPI",children:"\u4E0B\u8F7D OpenAPI"}),s("br",{}),s("a",{className:"text-[#f0f8ff]",onClick:()=>r(!1),href:"/api/v1/operateApi/sdk",download:"SDK",children:"\u4E0B\u8F7D React SDK"})]}),title:!1,trigger:"click",open:a,onOpenChange:l=>r(l),children:s(Wt,{style:{fontSize:"18px"},className:"ml-7 cursor-pointer"})})]}):g(G,{children:[s("div",{className:M.headBtn,onClick:()=>void z.get("/wdg/reStart").then(()=>void Z.success("\u6B63\u5728\u7F16\u8BD1...")),children:s("img",{src:wi,className:"h-5 w-5.25",alt:"\u7F16\u8BD1"})}),s("div",{className:M.headBtn,onClick:()=>window.open("/#/workbench/rapi","_blank"),children:s("img",{src:yi,className:"h-5 w-5",alt:"\u9884\u89C8"})}),s("div",{className:M.headBtn,children:s("img",{src:bi,className:"h-5 w-5",alt:"\u90E8\u7F72"})})]}),s("div",{className:M.splitLine,style:{margin:"0 26px"}}),s("div",{className:M.helpIcon,onClick:()=>n("/workbench/help")}),s("div",{className:M.configIcon,onClick:()=>n("/workbench/setting")}),s("div",{className:M.avatar,children:s("img",{className:"h-5 w-5",alt:"avatar",src:"/assets/total-user.png"})})]})})}const Ii=({sourceOptions:t,onChangeSource:n})=>{const{id:e}=xt(),i=oe(),a=()=>{i(Et)},r=u.exports.useRef();return u.exports.useEffect(()=>{var c;if(!t.length||r.current)return;r.current=!0;const l=location.hash.split("?")[1]||"",o=Number((c=l.match(/(?:^|\?|&)id=([\d+])/))==null?void 0:c[1]);n(o)},[t]),s("div",{className:ee["select-contain"],children:s(Re,{className:ee.select,onChange:n,optionLabelProp:"label",value:e,dropdownRender:l=>g("div",{className:"divide-y",children:[l,s("div",{className:"text-center",children:s(Ve,{className:"w-full",icon:s(Ht,{}),type:"link",onClick:a,children:"\u7BA1\u7406"})})]}),children:t.map(({id:l,name:o})=>s(Re.Option,{label:o,value:l,children:o},l))})})},Ri=({entity:t,onClick:n,onToggleDesigner:e,setShowType:i})=>{const{currentEntityId:a,changeToEntityById:r}=Ct(),{blocks:l,updateAndSaveBlock:o}=St(),[c,p]=se(!1),[f,h]=se(t.name===""),[w,y]=se(!1),{getFirstEntity:A}=Je(),E=a===t.id,N=_=>{_.domEvent.stopPropagation(),(_.key==="1"||_.key==="2")&&y(!1)},D=_=>{_.key==="Escape"&&h(!1)},T=()=>{var _,R,k;E&&(r((R=(_=A())==null?void 0:_.id)!=null?R:0),i(((k=A())==null?void 0:k.type)==="model"?"preview":"editEnum")),o(Ie(l).deleteEntity(t.id))},x=_=>{if(h(!1),!_){Z.error("\u5B9E\u4F53\u540D\u4E0D\u53EF\u4E3A\u7A7A\uFF01");return}const R=new RegExp(Nt).test(_);if(_===kt||!R){Z.error("\u5B9E\u4F53\u540D\u4E0D\u5408\u6CD5\uFF01");return}o(Ie(l).updateEntityName(t.id,_)).then(()=>Z.success("\u5B9E\u4F53\u540D\u66F4\u65B0\u6210\u529F")).catch(k=>Z.error(`\u5B9E\u4F53\u540D\u66F4\u65B0\u5931\u8D25, error: ${k.message}`))},d=_=>{_||(p(!1),y(!1))},v=()=>s(we,{onClick:N,items:[{key:1,label:s("span",{className:"ml-1.5",children:"\u91CD\u547D\u540D"}),icon:s(q,{}),onClick:()=>h(!f)},{key:2,label:s("span",{className:"ml-1.5",children:"\u7F16\u8F91"}),icon:s(q,{}),onClick:()=>e(t)},{key:3,label:s(Se,{className:"w-full h-full",placement:"right",title:"\u786E\u8BA4\u5220\u9664\u8BE5\u5B9E\u4F53\u5417\uFF1F\u5C06\u4F1A\u540C\u65F6\u5220\u9664\u5F15\u7528\u5B57\u6BB5\uFF01",onConfirm:T,okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",onCancel:()=>y(!1),overlayClassName:ee["delete-label"],okType:"danger",children:s("span",{className:"ml-1.5",children:"\u5220\u9664"})}),icon:s(Bt,{})}]}),b=f?s(Ce,{onBlur:_=>x(_.target.value),onKeyUp:D,onPressEnter:_=>x(_.currentTarget.value),className:"text-sm font-normal leading-4 h-5 w-5/7 pl-1",defaultValue:t.name,autoFocus:!0,placeholder:"\u8BF7\u8F93\u5165\u5B9E\u4F53\u540D"}):s("div",{className:"text-sm font-normal leading-4",children:t.name});return g("div",{className:`flex justify-start items-center py-3 cursor-pointer hover:bg-[#F8F8F9] ${E?"bg-[#F8F8F9]":""}`,onMouseEnter:()=>p(!0),onMouseLeave:()=>d(w),onClick:n,onDoubleClick:()=>h(!0),children:[s(Oe,{className:"mx-0.5",style:{visibility:E?"visible":"hidden"}}),t.type==="model"?s(q,{className:"ml-0.5 mr-2"}):s(qt,{className:"ml-0.5 mr-2"}),b,s(ve,{overlay:v,trigger:["click"],placement:"bottomRight",open:w,onOpenChange:_=>{y(_),d(_)},children:s(Oe,{onClick:_=>_.stopPropagation(),className:"m-auto mr-0 pr-2",style:{visibility:c?"visible":"hidden"}})})]},t.id)},Oi=({changeToER:t})=>g("div",{className:ee.actions,children:[s(q,{}),s(q,{}),s(q,{}),s(q,{}),s(q,{}),s(Pt,{onClick:t})]}),Mi=({sourceOptions:t,onChangeSource:n,onClickEntity:e,onToggleDesigner:i,changeToER:a,addNewModel:r,setShowType:l})=>{const{entities:o}=Je(),c=s(we,{items:[{key:"1",label:s("span",{onClick:r,children:"\u6A21\u578B"}),icon:s(q,{})}]});return g(G,{children:[g("div",{className:ee.pannel,children:[s("div",{className:ee.title,children:"\u6570\u636E\u5EFA\u6A21"}),s(Ii,{sourceOptions:t,onChangeSource:n}),s(Oi,{changeToER:a})]}),g("div",{className:"flex justify-between items-center p-4 my-3 border-[#5f62691a] border-b-1 border-t-1",children:[s("span",{className:"text-sm font-medium leading-5",children:"\u6240\u6709\u5B9E\u4F53"}),s(ve,{overlay:c,placement:"bottomRight",children:s(Ve,{className:ee["add-btn"],icon:s(zt,{}),shape:"circle",size:"small"})})]}),s("div",{className:"mt-3",children:o.map(p=>s(Ri,{setShowType:l,entity:p,onClick:()=>e(p),onToggleDesigner:i},p.id))})]})},Ti=Mi;var Wi=mt;function $i(t,n){var e=t==null?0:t.length;return!!e&&Wi(t,n,0)>-1}var Li=$i;function Pi(t,n,e){for(var i=-1,a=t==null?0:t.length;++i<a;)if(e(n,t[i]))return!0;return!1}var Yi=Pi;function ji(){}var Hi=ji,Ae=It,Vi=Hi,Ui=Ze,qi=1/0,Gi=Ae&&1/Ui(new Ae([,-0]))[1]==qi?function(t){return new Ae(t)}:Vi,Ki=Gi,Ji=Rt,Zi=Li,Xi=Yi,Qi=Ot,en=Ki,tn=Ze,nn=200;function sn(t,n,e){var i=-1,a=Zi,r=t.length,l=!0,o=[],c=o;if(e)l=!1,a=Xi;else if(r>=nn){var p=n?null:en(t);if(p)return tn(p);l=!1,a=Qi,c=new Ji}else c=n?[]:o;e:for(;++i<r;){var f=t[i],h=n?n(f):f;if(f=e||f!==0?f:0,l&&h===h){for(var w=c.length;w--;)if(c[w]===h)continue e;n&&c.push(h),o.push(f)}else a(c,h,e)||(c!==o&&c.push(h),o.push(f))}return o}var an=sn,rn=an;function on(t){return t&&t.length?rn(t):[]}var ln=on;const cn=ln,un="_container_e3f1g_1",hn="_active_e3f1g_8",dn="_header_e3f1g_14",pn="_arrow_e3f1g_24",fn="_headerOpen_e3f1g_31",mn="_title_e3f1g_34",gn="_add_e3f1g_45",vn="_action_e3f1g_51",wn="_content_e3f1g_58",H={container:un,active:hn,header:dn,arrow:pn,headerOpen:fn,title:mn,add:gn,action:vn,content:wn};function nt(t){const[n,e]=u.exports.useState(!1);u.exports.useEffect(()=>{t.open!==void 0?i(t.open):t.defaultOpen&&i(!0)},[t.defaultOpen,t.open]);const i=a=>{e(a),t.onOpen&&t.onOpen(a)};return g("div",{className:`${H.container} ${n?H.active:""}`,children:[g("div",{className:`${H.header} ${n?H.headerOpen:""}`,onClick:a=>i(!n),children:[s("div",{className:H.arrow}),s("div",{className:H.title,children:t.title}),g("div",{className:H.action,onClick:a=>a.stopPropagation(),children:[t.action?t.action:null,t.hideAdd?null:s(ne,{title:"\u65B0\u5EFA",children:s("div",{className:H.add,onClick:t.onAdd})})]})]}),s("div",{className:`${n?"":"hidden"} ${H.content}`,children:t.children})]})}const bn="_headerFilter_yn2wa_1",yn="_headerConfig_yn2wa_2",An="_headerRefresh_yn2wa_3",_n="_headerNewFold_yn2wa_4",xn="_headerNewFile_yn2wa_5",En="_treeContainer_yn2wa_25",Cn="_treeItem_yn2wa_83",Sn="_treeItemDir_yn2wa_89",Nn="_icon_yn2wa_89",kn="_treeItemFile_yn2wa_93",Fn="_lighting_yn2wa_97",Bn="_treeItemErr_yn2wa_100",zn="_title_yn2wa_104",Dn="_treeItemDisable_yn2wa_107",In="_suffix_yn2wa_140",Rn="_errLabel_yn2wa_145",On="_more_yn2wa_158",I={headerFilter:bn,headerConfig:yn,headerRefresh:An,headerNewFold:_n,headerNewFile:xn,treeContainer:En,treeItem:Cn,treeItemDir:Sn,icon:Nn,treeItemFile:kn,lighting:Fn,treeItemErr:Bn,title:zn,treeItemDisable:Dn,suffix:In,errLabel:Rn,more:On};function Mn(t){const n=oe(),e=le(),[i,a]=u.exports.useState(null),[r,l]=u.exports.useState([]),[o,c]=u.exports.useState(""),[p,f]=u.exports.useState(null),[h,w]=u.exports.useState(""),[y,A]=u.exports.useState(),[E,N]=u.exports.useState(!1),[D,T]=u.exports.useState(!1),[x,d]=u.exports.useState(!1),[v,b]=u.exports.useState(),[_,R]=u.exports.useState([]),k=u.exports.useMemo(()=>p?Ye(p,r):null,[p,r]),K=u.exports.useMemo(()=>Ye(o,r),[o,r]),{refreshMap:X,navCheck:J,triggerPageEvent:Y}=u.exports.useContext(ce);u.exports.useEffect(()=>{e.pathname!=="/workbench/apimanage"&&e.pathname!==`/workbench/apimanage/${(K==null?void 0:K.id)||" "}`&&c("")},[e]),u.exports.useEffect(()=>{t.defaultOpen&&d(!0)},[t.defaultOpen]),u.exports.useEffect(()=>{v&&(be(v),b(void 0))},[r]),u.exports.useEffect(()=>{!x||Be("/operateApi").then(m=>{var O,$;const B=Ee(m,"0");l(B);const S=Number(($=((O=e.pathname.match(/\/apimanage\/(\d+)/))!=null?O:[])[1])!=null?$:0);if(S){const C=Wn(S,B);ke(B,S),C!=null&&C.key&&c(C==null?void 0:C.key)}}).catch(m=>{throw m})},[x,y,X.api]),u.exports.useEffect(()=>{if(k){const m=Tn(r);if(!m)return;f(m.key)}},[r]),u.exports.useEffect(()=>{!E&&D&&(a(null),f(null),A(!y)),T(!1)},[E,D]);const W=u.exports.useCallback((m,{node:B})=>{(async()=>!await J()||(B.isDir?n("/workbench/apimanage",{replace:!0}):n(`/workbench/apimanage/${B.id}`,{replace:!0}),m[0]&&m[0]!==o?c(m[0]):c("")))()},[J]);function te(m){return m.legal?s("div",{className:I.errLabel,children:"\u975E\u6CD5"}):m.isPublic?m.method:"\u5185\u90E8"}const st=u.exports.useCallback(m=>w(m.target.value),[]),at=u.exports.useCallback(m=>{m.stopPropagation()},[]),be=m=>{var Q,Fe;if(!x){b(m),d(!0);return}a(m);const{parent:B,curr:S}=Pn(o,r),O={title:"",baseDir:(Q=S==null?void 0:S.currDir)!=null?Q:"",isDir:m==="\u521B\u5EFA\u76EE\u5F55",key:Date.now().toString()};(S==null?void 0:S.children)===null&&(S.children=[]);const $=r!=null?r:[];let C;S!=null&&S.isDir?C=S:B&&(C=B),C?((Fe=C.children)==null||Fe.push(O),_.includes(C.key)||R([..._,C.key])):$.push(O),f(O.key),l([...$])},Ne=()=>{if(!k){a(null);return}switch(i){case"\u91CD\u547D\u540D":k.isDir?$n(k,h).then(m=>{f(null),A(!y)}):Ln(k,h).then(m=>{f(null),m&&Ge.emit({event:"titleChange",data:{title:h,path:`${k.baseDir}/${h}`}}),A(!y)});break;case"\u521B\u5EFA\u76EE\u5F55":jn(k,h).then(()=>{f(null),A(!y)});break;case"\u521B\u5EFA\u6587\u4EF6":qe(h)?(f(null),A(!y)):pt(h.at(0))?(rt(),k.title=h):Z.warn("\u6587\u4EF6\u540D\u5FC5\u987B\u4EE5\u5927\u5199\u5B57\u6BCD\u5F00\u5934\uFF01");break}},rt=()=>{if(i==="\u521B\u5EFA\u6587\u4EF6"){if(!k)return;Hn(k,h).then(m=>{m!=null&&m.id&&(n(`/workbench/apimanage/${m==null?void 0:m.id}`),f(null),A(!y))}).catch(m=>{a("\u521B\u5EFA\u6587\u4EF6")})}a(null)},ot=m=>{Yn(m).then(()=>{if(f(null),A(!y),`/workbench/apimanage/${m.id}`===e.pathname){const B=ke(r);B?W([B.key],{node:B}):n("/workbench/apimanage")}})},ke=(m,B)=>{const S=[];let O;for(let C=0;C<m.length;C++){const Q=m[C];if(O=$(Q),O)break}function $(C){if(!C.isDir&&(!B||B===C.id))return C;if(C.children){const Q=C.children.find($);if(Q)return S.push(C.key),Q}}return O?(R(cn([..._,...S])),O):!1},lt=m=>{const B=te(m);let S;m.isDir?S=I.treeItemDir:m.legal?S=I.treeItemErr:m.enable?S=I.treeItemFile:S=I.treeItemDisable;let O=[{key:"rename",label:g("div",{onClick:()=>{f(m.key),a("\u91CD\u547D\u540D")},children:[s(ae,{type:"icon-zhongmingming"}),s("span",{className:"ml-1.5",children:"\u91CD\u547D\u540D"})]})},{key:"delete",label:s(Se,{title:"\u786E\u5B9A\u5220\u9664\u5417?",onConfirm:()=>ot(m),okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",placement:"right",children:g("a",{href:"#",onClick:C=>C.stopPropagation(),children:[s(ae,{type:"icon-shanchu"}),s("span",{className:"ml-1.5",children:"\u5220\u9664"})]})})}];m.isDir&&(O=O.filter(C=>C.key!=="edit"));const $=s(we,{items:O});return g("div",{className:`${I.treeItem} ${S}`,children:[s("div",{className:I.icon,children:m.liveQuery?s("div",{className:I.lighting}):null}),p&&m.key===p?s(Ce,{size:"small",defaultValue:m.title,onPressEnter:Ne,onBlur:()=>{h?Ne():(f(null),A(!y))},onChange:st,autoFocus:!0,onClick:at}):g(G,{children:[s("div",{className:I.title,children:m.title}),s("div",{className:I.suffix,children:B}),s(ve,{overlay:$,trigger:["click"],placement:"bottomRight",children:s("div",{className:I.more,onClick:C=>C.stopPropagation()})})]})]})};return g(nt,{...t,title:"API\u7BA1\u7406",hideAdd:!0,open:x,onOpen:m=>{d(m),t.onOpen&&t.onOpen(m)},action:g(G,{children:[s(ne,{title:"\u5237\u65B0\u5217\u8868",children:s("div",{className:I.headerRefresh,onClick:()=>{Be("/operateApi").then(m=>l(Ee(m))).then(()=>Z.success("\u5237\u65B0\u5B8C\u6210\uFF01")).catch(m=>{throw Z.error("\u83B7\u53D6\u6587\u4EF6\u5217\u8868\u5931\u8D25\uFF01"),m})}})}),s(ne,{title:"\u5168\u5C40\u8BBE\u7F6E",children:s("div",{className:I.headerConfig,onClick:()=>N(!0)})}),s(ne,{title:"\u65B0\u5EFA\u76EE\u5F55",children:s("div",{className:I.headerNewFold,onClick:()=>be("\u521B\u5EFA\u76EE\u5F55")})}),s(ne,{title:"\u65B0\u5EFAAPI",children:s("div",{className:I.headerNewFile,onClick:()=>be("\u521B\u5EFA\u6587\u4EF6")})})]}),children:[s("div",{className:I.treeContainer,children:r.length?s(Dt,{rootClassName:"overflow-auto",titleRender:lt,showIcon:!0,defaultExpandParent:!0,expandedKeys:_,onExpand:R,treeData:r,selectedKeys:[o],onSelect:W}):null}),s(He,{title:"API\u5168\u5C40\u8BBE\u7F6E",open:E,onOk:()=>{N(!1)},onCancel:()=>{N(!1)},footer:null,centered:!0,children:s(gt,{type:"global",onClose:()=>N(!1)})})]})}function Ee(t,n="0"){return t?t.map((e,i)=>({...e,key:`${n}-${i}`,title:e.path.split("/")[e.path.split("/").length-1],baseDir:e.path.split("/").slice(0,-1).join("/"),currDir:e.isDir?e.path:e.path.split("/").slice(0,-1).join("/"),children:Ee(e.children,`${n}-${i}`)})):[]}function Tn(t){let n;const e=i=>{!i||i.find(a=>{var r;return a.title===""?(n=a,a):e((r=a.children)!=null?r:void 0)})};return e(t),n}function Wn(t,n){let e;const i=(a,r)=>{!r||r.find(l=>{var o;return l.id===t?(e=l,l):i(a,(o=l.children)!=null?o:void 0)})};return i(t,n),e}function Ye(t,n){let e;const i=(a,r)=>{!r||r.find(l=>{var o;return l.key===a?(e=l,l):i(a,(o=l.children)!=null?o:void 0)})};return i(t,n),e}function $n(t,n){return z.put("/operateApi/dir",{oldPath:`${t.path}`,newPath:`${t.baseDir}/${n}`})}function Ln(t,n){return z.put(`/operateApi/${t.id}`,{...t,path:`${t.baseDir}/${n}`})}function Pn(t,n){let e,i;const a=(r,l)=>{if(!l)return[];e=void 0,l.find(o=>{var c;return o.key===r?(i=o,[e,i]):(qe(o.children)||(e=o),a(r,(c=o.children)!=null?c:void 0))})};return a(t,n),e=i?e:void 0,{parent:e,curr:i}}function Yn(t){return t.isDir?z.delete("/operateApi/dir",{data:{path:t.path}}):z.delete(`/operateApi/${t.id}`)}function jn(t,n){return z.post("/operateApi/dir",{path:`${t.baseDir}/${n}`})}function Hn(t,n){return z.post("/operateApi",{path:`${t.baseDir}/${n}`})}function Vn(t,n){switch(n.type){case"fetched":return n.data;case"selected":return t;case"added":return[...t,n.data];case"changed":return t.map(e=>e.id===n.data.id?n.data:e);case"deleted":return t.filter(e=>e.id!==n.data.id);default:return t}}const Un="_container_18kpt_1",qn="_row_18kpt_4",Gn="_active_18kpt_16",Kn="_rowDisable_18kpt_30",Jn="_icon_18kpt_30",Zn="_title_18kpt_33",Xn="_tip_18kpt_52",Qn="_more_18kpt_59",V={container:Un,row:qn,active:Gn,rowDisable:Kn,icon:Jn,title:Zn,tip:Xn,more:Qn},es={dataSource:{title:"\u6570\u636E\u6E90",openItem:t=>`/workbench/dataSource/${t}`,newItem:"/workbench/dataSource/new",request:{getList:t=>{z.get("/dataSource").then(n=>{t({type:"fetched",data:n.map(e=>{let i="other",a="";switch(e.sourceType){case 1:i=String(e.config.dbType).toLowerCase()||i,a=String(e.config.dbName||"");break;case 2:i="rest";break;case 3:i="graphql";break}return{id:e.id,name:e.name,icon:i,tip:a,switch:e.switch,_row:e}})})})},editItem:async t=>await z.put("/dataSource",t),delItem:async t=>await z.delete(`/dataSource/${t}`)}},storage:{title:"\u6587\u4EF6\u5B58\u50A8",openItem:t=>`/workbench/storage/${t}/manage`,newItem:"/workbench/storage/new",request:{getList:t=>{z.get("/storageBucket").then(n=>{t({type:"fetched",data:n.map(e=>{const i="other",a="";return{id:e.id,name:e.name,icon:i,tip:a,switch:e.switch,_row:e}})})})},editItem:async t=>await z.put("/storageBucket",t),delItem:async t=>await z.delete(`/storageBucket/${t}`)},navMenu:[{icon:"icon-wenjian1",name:"\u67E5\u770B",menuPath:t=>`/workbench/storage/${t}`}]},auth:{title:"\u8EAB\u4EFD\u9A8C\u8BC1",openItem:t=>`/workbench/auth/${t}`,newItem:"/workbench/auth/new",navAction:[{icon:"/assets/workbench/panel-role.png",path:"/workbench/auth/role",tooltip:"\u6743\u9650\u7BA1\u7406"}],request:{getList:t=>{z.get("/auth").then(n=>{const e=n.map(i=>{const a="other",r="openid";return{id:i.id,name:i.name,icon:a,tip:r,switch:i.switch,_row:i}});e.unshift({disableMenu:!0,switch:1,icon:"other",name:"\u9ED8\u8BA4\u8BA4\u8BC1\u5668",_row:{name:""},id:0,tip:"\u524D\u5F80>",openInNewPage:"#/auth/userManage"}),t({type:"fetched",data:e})})},editItem:async t=>await z.put("/auth",t),delItem:async t=>await z.delete(`/auth/${t}`)}}};function _e(t){var x;const n=u.exports.useMemo(()=>es[t.type],[t.type]),e=oe(),i=le(),[a,r]=u.exports.useState(),[l,o]=u.exports.useState(),[c,p]=u.exports.useReducer(Vn,[]),{refreshMap:f,navCheck:h}=u.exports.useContext(ce),[w,y]=u.exports.useState(!1),A=f[t.type];u.exports.useEffect(()=>{!w||n.request.getList(p)},[t.type,A,w]);const E=d=>{const v=[{key:"rename",label:g("div",{onClick:()=>r(d),children:[s(ae,{type:"icon-zhongmingming"}),s("span",{className:"ml-1.5",children:"\u91CD\u547D\u540D"})]})},{key:"delete",label:s(Se,{placement:"right",title:"\u786E\u8BA4\u5220\u9664\u8BE5\u5B9E\u4F53\u5417\uFF1F",onConfirm:()=>void N(l),okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",overlayClassName:V["delete-label"],okType:"danger",children:g("div",{children:[s(ae,{type:"icon-a-shanchu2"}),s("span",{className:"ml-1.5",children:"\u5220\u9664"})]})})}];return n.navMenu&&v.unshift(...n.navMenu.map(b=>({key:b.name,label:g("div",{onClick:()=>e(b.menuPath(d.id)),children:[s(ae,{type:b.icon}),s("span",{className:"ml-1.5",children:b.name})]},d.id)}))),s(we,{onClick:b=>{b.key!=="delete"&&o(void 0)},items:v})},N=async d=>{if(!!d&&(await n.request.delItem(d),n.request.getList(p),o(void 0),n.openItem(d)===i.pathname)){const v=c.findIndex(b=>!b.openInNewPage);v>=0&&T(c[v])}},D=async d=>{const v=a==null?void 0:a._row;v!==void 0&&(v.name=d,await n.request.editItem(v),n.request.getList(p),r(void 0))},T=d=>{if(d.openInNewPage){window.open(d.openInNewPage);return}const v=n.openItem(d.id);h().then(b=>{b&&e(v)})};return s(nt,{title:n.title,onAdd:()=>e(n.newItem),onOpen:d=>y(d),defaultOpen:t.defaultOpen,action:s(G,{children:(x=n.navAction)==null?void 0:x.map(d=>g(ne,{title:d.tooltip,children:[s("div",{className:"flex mr-1.5",onClick:()=>e(d.path),children:s("img",{width:19,height:19,src:d.icon,alt:"\u5934\u50CF"})})," "]},d.path))}),children:s("div",{className:V.container,children:c.map(d=>{const v=n.openItem(d.id);return g("div",{className:`${V.row} ${d.switch?"":V.rowDisable} ${v===i.pathname?V.active:""}`,onClick:()=>T(d),children:[s("div",{className:V.icon,children:s(xe,{width:12,height:12,preview:!1,alt:d.name,src:`/assets/workbench/panel-item-${d.icon}.png`})}),(a==null?void 0:a.id)===d.id?s(Ce,{onPressEnter:b=>void D(b.target.value),onBlur:b=>void D(b.target.value),onKeyUp:b=>{b.key=="Escape"&&r(void 0)},className:"text-sm font-normal leading-4 h-5 w-5/7",defaultValue:a.name,autoFocus:!0,placeholder:"\u8BF7\u8F93\u5165\u5916\u90E8\u6570\u636E\u6E90\u540D"}):s("div",{className:V.title,children:d.name}),s("div",{className:V.tip,children:d.tip}),!d.disableMenu&&s("div",{onClick:b=>b.stopPropagation(),children:s(ve,{overlay:E(d),trigger:["click"],open:l===d.id,onOpenChange:b=>{o(b?d.id:void 0),console.log(l)},placement:"bottomRight",children:s("div",{className:V.more,onClick:b=>b.preventDefault()})})})]},d.id)})})})}const ts="_container_xritx_1",is="_tabs_xritx_6",ns="_tabs_inner_xritx_11",ss="_tabs_tab_xritx_19",as="_tabs_tab__active_xritx_30",rs="_apiIcon_xritx_36",os="_dataIcon_xritx_42",ls="_panels_xritx_60",U={container:ts,tabs:is,tabs_inner:ns,tabs_tab:ss,tabs_tab__active:as,apiIcon:rs,dataIcon:os,panels:ls},je={api:"/workbench",data:"/workbench/modeling"};function cs(){const[t,n]=u.exports.useState(""),e=le(),i=oe();u.exports.useContext(ce),u.exports.useEffect(()=>{const h=e.pathname.startsWith("/workbench/modeling")?"data":"api";n(h)},[e.pathname]);const{panel:a}=u.exports.useContext(Ke),{handleToggleDesigner:r,handleClickEntity:l,handleChangeSource:o,setShowType:c,dataSources:p}=a||{},f=h=>{je[t]=e.pathname,i(je[h])};return g("div",{className:"flex flex-col h-full",children:[s("div",{className:U.tabs,children:g("div",{className:U.tabs_inner,children:[g("div",{className:`${U.tabs_tab} ${t==="api"?U.tabs_tab__active:""}`,onClick:()=>{f("api")},children:[s("div",{className:U.apiIcon}),"API\u8BBE\u8BA1"]}),g("div",{className:`${U.tabs_tab}  ${t==="data"?U.tabs_tab__active:""}`,onClick:()=>{f("data")},children:[s("div",{className:U.dataIcon}),"\u6570\u636E\u5EFA\u6A21"]})]})}),t==="api"?g("div",{className:U.panels,children:[s(Mn,{defaultOpen:e.pathname.startsWith("/workbench/apimanage/")}),s(_e,{type:"dataSource",defaultOpen:e.pathname.startsWith("/workbench/dataSource/")}),s(_e,{type:"auth",defaultOpen:e.pathname.startsWith("/workbench/auth/")}),s(_e,{type:"storage",defaultOpen:e.pathname.startsWith("/workbench/storage/")})]}):null,t==="data"&&a?s(Ti,{setShowType:c,changeToER:()=>c("erDiagram"),addNewModel:()=>c("newModel"),addNewEnum:()=>c("newEnum"),sourceOptions:p,onChangeSource:h=>o(h),onClickEntity:l,onToggleDesigner:r}):null]})}const us="_workbench_hu69e_1",hs="_header_hu69e_1",ds="_footer_hu69e_5",ps="_sider_hu69e_11",fe={workbench:us,header:hs,footer:ds,sider:ps},{Header:fs,Footer:ms,Sider:gs,Content:vs}=me;function ws(t){const[n,e]=u.exports.useState(),[i,a]=u.exports.useState("--"),[r,l]=u.exports.useState("--"),[o,c]=u.exports.useState(!1),[p,f]=u.exports.useState(!1),h=u.exports.useRef(),[w,y]=u.exports.useState(!1),[A,E]=se({api:!1,auth:!1,dataSource:!1,storage:!1});u.exports.useEffect(()=>{z.get("/wdg/barOnce").then(v=>{a(v.version),l(v.env)})},[]),u.exports.useEffect(()=>{const v=new AbortController,b=v.signal;return fetch("/api/v1/wdg/state",{signal:b}).then(_=>{var K;const R=(K=_.body)==null?void 0:K.getReader();if(!R)return;const k=({value:X,done:J})=>{if(!J){try{const Y=new Response(X);console.log(Y),Y.text().then(W=>{const te=Ue(W).pop();te&&(e(te),te.engineStatus==="\u5DF2\u542F\u52A8"&&Ge.emit({event:"compileFinish"}))})}catch(Y){console.log(Y)}R.read().then(k)}};R.read().then(k)}),()=>{v.abort()}},[]);const N=v=>{E(b=>{b[v]=!b[v]})},D=v=>{y(v)},T=u.exports.useCallback(async()=>w?await new Promise(v=>{He.confirm({title:"\u5373\u5C06\u79BB\u5F00\u5F53\u524D\u9875\u9762\uFF0C\u4E3A\u4FDD\u5B58\u7684\u5185\u5BB9\u5C06\u88AB\u90FD\u662F\uFF0C\u662F\u5426\u786E\u8BA4\uFF1F",onOk:()=>{y(!1),v(!0)},onCancel:()=>v(!1)})}):!0,[w]),x=g(me,{className:`h-100vh ${fe.workbench}`,children:[s(fs,{className:fe.header,children:s(Di,{onToggleSider:()=>f(!p)})}),g(me,{children:[s(gs,{width:230,style:{marginLeft:p?-230:0},theme:"light",className:fe.sider,children:s(cs,{})}),g(me,{className:"relative",children:[s(vs,{className:"bg-[#FBFBFB]",children:t.children}),o?s(mi,{style:{left:0,right:0,bottom:0},toggleWindow:()=>c(!o)}):s(G,{})]})]}),s(ms,{className:fe.footer,children:s(ii,{version:i,env:r,errorInfo:n==null?void 0:n.errorInfo,startTime:n==null?void 0:n.startTime,engineStatus:n==null?void 0:n.engineStatus,hookStatus:n==null?void 0:n.hookStatus,toggleWindow:()=>c(!o)})})]});return le().pathname.match(/^\/workbench\/modeling($|\/)/)?s(vi,{children:x}):s(ce.Provider,{value:{triggerPageEvent:v=>{var b;(b=h.current)==null||b.call(h,v)},registerPageListener:v=>{h.current=v},refreshMap:A,onRefreshMenu:N,editFlag:w,markEdit:D,navCheck:T,setFullscreen:f,isFullscreen:p},children:x})}function xa(){const{config:t}=u.exports.useContext(ut);return t?s(ws,{children:s(ht,{})}):null}export{xa as default};
