import{r as E,a as e,j as c,F as x,a9 as p}from"./index.bb86fbbf.js";import{B as h}from"./button.aa0bb50b.js";import{C as N}from"./index.9ea41163.js";import{F as s}from"./index.2f0a4123.js";import"./row.b57345b2.js";import"./index.61964446.js";import{I as n}from"./index.837f2673.js";import{R as F}from"./index.11df8be1.js";import{l as R}from"./Editor.6c4f1911.js";import{E as $}from"./index.db465a01.js";import{i as m}from"./use-immer.module.c8467ba8.js";import{E as z}from"./50x.88c69611.js";import{e as J,c as q}from"./User.914c3ecd.js";import{s as w}from"./subs.module.7d96a7ba.js";R.config({paths:{vs:"/modules/monaco-editor/min/vs"}});const O=[{label:"\u57FA\u4E8ECookie",value:"cookieBased"},{label:"\u57FA\u4E8EToken",value:"tokenBased"}];function ae({content:u,onChange:b,onTest:C}){const{handleBottomToggleDesigner:B}=E.exports.useContext(J);E.exports.useContext(q);const[g]=s.useForm(),[A,D]=m(""),a=u.config,[_,k]=m(a.jwks==1),[G,f]=m(!1),[i,I]=m("");if(!u)return e(z,{});const S=async t=>{const o={...a,...t},r={...u,switchState:t.switchState,name:t.id};if(u.name==""){const l={...r,config:o};Reflect.deleteProperty(l,"id");const d=await p.post("/auth",l);u.id=d}else await p.put("/auth",{...r,config:o});p.get("/auth").then(l=>{b(l.filter(d=>d.id===u.id)[0])}).then(()=>{B("data",u.id)})},v=t=>{D(t),k(t=="1")},y=(t,o)=>{I(o.issuer);for(const r in o)if(o[r]==null){f(!0);return}f(!1)},j=u.name?{id:a.id,clientId:a.clientId,clientSecret:a.clientSecret,issuer:a.issuer,jwks:a.jwks,jwksJSON:a.jwksJSON,switchState:u.switchState}:{id:"",clientId:"",clientSecret:"",issuer:"",jwks:0,jwksJSON:"",switchState:[]};return c(x,{children:[e("div",{className:`${w["db-check-setting"]}  mt-2 cursor-pointer`,children:e("span",{className:" w-19 h-5 float-right"})}),e("div",{className:`${w["edit-form-contain"]} py-6 rounded-xl mb-4`,children:c(s,{form:g,style:{width:"90%"},name:"basic",labelCol:{span:4},wrapperCol:{span:11},onFinish:t=>{S(t)},onValuesChange:y,autoComplete:"new-password",validateTrigger:"onBlur",initialValues:j,children:[e(s.Item,{label:"\u4F9B\u5E94\u5546ID",name:"id",rules:[{required:!0,message:"\u4F9B\u5E94\u5546ID\u4E0D\u80FD\u4E3A\u7A7A"},{pattern:new RegExp("^\\w+$","g"),message:"\u53EA\u5141\u8BB8\u5305\u542B\u5B57\u6BCD\uFF0C\u6570\u5B57\uFF0C\u4E0B\u5212\u7EBF"}],children:e(n,{placeholder:"\u8BF7\u8F93\u5165...",autoComplete:"off",autoFocus:!0})}),e(s.Item,{label:"App ID",name:"clientId",rules:[{required:!0,message:"App ID\u4E0D\u80FD\u4E3A\u7A7A"},{pattern:new RegExp("^\\w+$","g"),message:"\u53EA\u5141\u8BB8\u5305\u542B\u5B57\u6BCD\uFF0C\u6570\u5B57\uFF0C\u4E0B\u5212\u7EBF"}],children:e(n,{placeholder:"\u8BF7\u8F93\u5165..."})}),e(s.Item,{label:"App Secret",name:"clientSecret",rules:[{required:!0,message:"App Secret\u4E0D\u80FD\u4E3A\u7A7A"},{pattern:new RegExp("^\\w+$","g"),message:"\u53EA\u5141\u8BB8\u5305\u542B\u5B57\u6BCD\uFF0C\u6570\u5B57\uFF0C\u4E0B\u5212\u7EBF"}],children:e(n.Password,{placeholder:"\u8BF7\u8F93\u5165..."})}),e(s.Item,{label:"Issuer",name:"issuer",rules:[{required:!0,message:"Issuer\u4E0D\u80FD\u4E3A\u7A7A"},{pattern:/^https?:\/\/[:.\w\d/]+$/,message:"\u53EA\u5141\u8BB8\u8F93\u5165\u94FE\u63A5"}],children:e(n,{placeholder:"\u8BF7\u8F93\u5165...",value:i})}),e(s.Item,{label:"\u670D\u52A1\u53D1\u73B0\u5730\u5740",children:e(n,{value:`${i}/.well-known/openid-configuration`,disabled:!0})}),e(s.Item,{label:"JWKS",name:"jwks",children:c(F.Group,{onChange:t=>{v(t.target.value)},value:A,children:[e(F,{value:0,children:"URL"}),e(F,{value:1,children:"JSON"})]})}),_?e(s.Item,{label:"jwksJSON",name:"jwksJSON",className:"mb-5",wrapperCol:20,children:e($,{defaultLanguage:"typescript",defaultValue:"// some comment",className:w["monaco-edit"]})}):e(s.Item,{label:"jwksURL",children:e(n,{disabled:!0,value:`${i}/.well-known/jwks.json`,suffix:"\u6D4F\u89C8"})}),e(s.Item,{label:"\u7528\u6237\u7AEF\u70B9",children:e(n,{disabled:!0,value:`${i}/me`})}),e(s.Item,{label:"\u662F\u5426\u5F00\u542F",name:"switchState",children:e(N.Group,{options:O})}),c(s.Item,{wrapperCol:{offset:4,span:16},children:[e(h,{className:"btn-cancel",onClick:()=>B("data",u.id),children:e("span",{children:"\u53D6\u6D88"})}),e(h,{className:"btn-test ml-4",onClick:C,children:"\u6D4B\u8BD5"}),e(h,{className:"btn-save ml-4",onClick:()=>{g.submit()},children:"\u4FDD\u5B58"})]})]})})]})}const V="_select_usz5y_1",T="_actions_usz5y_4",L="_manage_usz5y_9",ne={select:V,actions:T,manage:L,"option-icon":"_option-icon_usz5y_12","select-contain":"_select-contain_usz5y_18","delete-label":"_delete-label_usz5y_25","save-btn":"_save-btn_usz5y_28","connect-check-btn-common":"_connect-check-btn-common_usz5y_46","user-info":"_user-info_usz5y_56"};export{ae as A,ne as s};
