import{r as a,a as e,F as x,j as o,b as I,a9 as f,aa as v,aw as N}from"./index.bb86fbbf.js";import{H as B}from"./Helmet.0418c866.js";import{i as w}from"./use-immer.module.c8467ba8.js";import{B as d}from"./button.aa0bb50b.js";import{S as g}from"./index.445b6a21.js";import{W as C}from"./workbenchContext.3d2abc29.js";/* empty css               */import{D as u}from"./index.2ab34b44.js";import{E as y}from"./EyeOutlined.7a3a19f7.js";import{E as A,I as m}from"./index.837f2673.js";import{F as i}from"./index.2f0a4123.js";import"./row.b57345b2.js";import"./index.61964446.js";/* empty css               *//* empty css               */import"./index.34a54fb6.js";import"./index.10921ee9.js";import"./omit.fd69d8d2.js";import"./type.4482a080.js";import"./Portal.a4c68d61.js";import"./responsiveObserve.57a0a6d3.js";import"./context.24d2ae58.js";import"./_baseIsEqual.08bd8828.js";import"./statusUtils.077f8a48.js";import"./SearchOutlined.7a88f9ff.js";import"./styleChecker.d685456c.js";import"./SearchOutlined.5704e58e.js";a.exports.createContext([]);a.exports.createContext({});a.exports.createContext({});const k=a.exports.createContext({}),F={"save-btn":"_save-btn_dfcko_1","center-btn":"_center-btn_dfcko_19","switch-check-btn":"_switch-check-btn_dfcko_27","ssl-open-btn":"_ssl-open-btn_dfcko_34","ssl-close-btn":"_ssl-close-btn_dfcko_47","switch-set-btn":"_switch-set-btn_dfcko_64","form-contain":"_form-contain_dfcko_71","panel-style":"_panel-style_dfcko_74","form-item-icon":"_form-item-icon_dfcko_81"};function E({content:s}){const[l,t]=w(!1),r=a.exports.useMemo(()=>s==null?void 0:s.config,[s==null?void 0:s.config]);return e(x,{children:e("div",{className:"pr-110px",children:o(u,{bordered:!0,column:1,size:"small",children:[e(u.Item,{label:"\u540D\u79F0",children:s==null?void 0:s.name}),e(u.Item,{label:"\u670D\u52A1\u5730\u5740",children:r==null?void 0:r.endpoint}),o(u.Item,{label:"APP ID",children:[r==null?void 0:r.accessKeyID," "]}),e(u.Item,{label:"APP Secret",children:e("span",{children:l?o("div",{children:[r==null?void 0:r.secretAccessKey,e(y,{className:"ml-6 cursor-pointer",onClick:()=>t(!l)})]}):o("div",{children:[r==null?void 0:r.secretAccessKey.replaceAll(/./g,"*"),e(A,{className:"ml-6 cursor-pointer",onClick:()=>t(!l)})]})})}),e(u.Item,{label:"\u533A\u57DF",children:r==null?void 0:r.bucketLocation}),e(u.Item,{label:"bucketName",children:r==null?void 0:r.bucketName}),e(u.Item,{label:"\u5F00\u542FSSL",children:r!=null&&r.useSSL?e(d,{className:F["ssl-open-btn"],children:"\u5F00\u542F"}):e(d,{className:F["ssl-close-btn"],children:"\u5173\u95ED"})})]})})})}function P({content:s}){const{handleSwitch:l}=a.exports.useContext(k),t=I(),{onRefreshMenu:r}=a.exports.useContext(C),c=a.exports.useMemo(()=>s==null?void 0:s.config,[s]),[h]=i.useForm(),n=async p=>{const S={name:p.name,config:p,useSSL:!0};let _;s?_=await f.put("/storageBucket ",{...S,id:s.id}):_=await f.post("/storageBucket ",S),t(`/workbench/storage/${_.id}`,{replace:!0}),r("storage"),l("detail",_.id)},b=p=>{v.error("\u4FDD\u5B58\u5931\u8D25\uFF01")},D=()=>{};return e("div",{className:`${F["form-contain"]}`,children:o(i,{form:h,name:"basic",labelCol:{span:4},wrapperCol:{span:11},onFinish:p=>void n(p),onFinishFailed:b,autoComplete:"off",validateTrigger:"onBlur",className:"ml-3",initialValues:{...c},children:[e(i.Item,{label:"\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0"}],name:"name",children:e(m,{placeholder:"\u8BF7\u8F93\u5165..."})}),e(i.Item,{label:"\u670D\u52A1\u5730\u5740",name:"endpoint",children:e(m,{placeholder:"\u8BF7\u8F93\u5165..."})}),e(i.Item,{label:"App ID",rules:[{required:!0,message:"\u8BF7\u8F93\u5165 App ID"}],name:"accessKeyID",children:e(m,{placeholder:"\u8BF7\u8F93\u5165..."})}),e(i.Item,{label:"App Secret",rules:[{required:!0,message:"\u8BF7\u8F93\u5165 App Secret"}],name:"secretAccessKey",children:e(m.Password,{placeholder:"\u8BF7\u8F93\u5165..."})}),e(i.Item,{label:"\u533A\u57DF",name:"bucketLocation",children:e(m,{placeholder:"\u8BF7\u8F93\u5165..."})}),e(i.Item,{label:"bucketName",name:"bucketName",children:e(m,{placeholder:"\u8BF7\u8F93\u5165..."})}),e(i.Item,{label:"\u5F00\u542FSSL",style:{marginTop:"29px"},name:"useSSL",valuePropName:"checked",children:e(g,{className:F["switch-set-btn"],size:"small"})}),o(i.Item,{wrapperCol:{offset:4,span:16},children:[e(d,{className:"btn-cancel",onClick:()=>l("detail",s==null?void 0:s.id),children:e("span",{children:"\u53D6\u6D88"})}),e(d,{className:"btn-test ml-4",onClick:()=>D(),children:"\u6D4B\u8BD5"}),e(d,{className:"btn-save ml-4",onClick:()=>h.submit(),children:"\u4FDD\u5B58"})]})]})})}function L({content:s,showType:l}){const{onRefreshMenu:t}=a.exports.useContext(C),{handleSwitch:r}=a.exports.useContext(k),c=async()=>{!s||(s.switch^=1,s&&await f.put("/storageBucket ",s),t("storage"),r("detail",s==null?void 0:s.id))};return o("div",{className:"common-form h-full flex items-stretch justify-items-stretch flex-col",children:[o("div",{className:"h-54px flex-0 bg-white flex items-center pl-11",children:[e("img",{src:"/assets/ant-tree/file.png",className:"w-14px h-14px mr-1.5",alt:"\u6587\u4EF6"}),s==null?void 0:s.name,e("div",{className:"flex-1"}),l==="detail"?o(x,{children:[e(g,{checked:(s==null?void 0:s.switch)===1,checkedChildren:"\u5F00\u542F",unCheckedChildren:"\u5173\u95ED",onChange:c}),e(d,{className:"btn-save  ml-4 mr-11",onClick:()=>r("form",s==null?void 0:s.id),children:"\u7F16\u8F91"})]}):null]}),e("div",{className:"rounded-4px flex-1 min-h-0 overflow-y-auto bg-white pl-8 mx-3 mt-3 pt-8",children:l==="detail"?e(E,{content:s}):l==="form"?e(P,{content:s}):""})]})}function ue(){const{id:s}=N(),[l,t]=w("detail"),[r,c]=a.exports.useState();a.exports.useEffect(()=>{if(s==="new"){t("form"),c(void 0);return}f.get("/storageBucket").then(n=>{c(n.filter(b=>b.id===Number(s))[0]),t("detail")})},[s,l]);function h(n,b){t(n)}return o(x,{children:[e(B,{children:e("title",{children:"FireBoom - \u6587\u4EF6\u5B58\u50A8"})}),e(k.Provider,{value:{handleSwitch:h},children:e(L,{showType:l,content:r})})]})}export{ue as default};
