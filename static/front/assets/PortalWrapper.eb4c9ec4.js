import{x as $,v as T,f as N,q as R,s as P,r as _,w as E,a as O,I as D,l as H}from"./index.bb86fbbf.js";import{P as U}from"./Portal.a4c68d61.js";var C;function k(s){if(typeof document>"u")return 0;if(s||C===void 0){var r=document.createElement("div");r.style.width="100%",r.style.height="200px";var n=document.createElement("div"),o=n.style;o.position="absolute",o.top="0",o.left="0",o.pointerEvents="none",o.visibility="hidden",o.width="200px",o.height="150px",o.overflow="hidden",n.appendChild(r),document.body.appendChild(n);var e=r.offsetWidth;n.style.overflow="scroll";var t=r.offsetWidth;e===t&&(t=n.clientWidth),document.body.removeChild(n),C=e-t}return C}function L(s){var r=s.match(/^(.*)px$/),n=Number(r==null?void 0:r[1]);return Number.isNaN(n)?k():n}function q(s){if(typeof document>"u"||!s||!(s instanceof Element))return{width:0,height:0};var r=getComputedStyle(s,"::-webkit-scrollbar"),n=r.width,o=r.height;return{width:L(n),height:L(o)}}function p(s){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!s)return{};var n=r.element,o=n===void 0?document.body:n,e={},t=Object.keys(s);return t.forEach(function(i){e[i]=o.style[i]}),t.forEach(function(i){o.style[i]=s[i]}),e}function z(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var b={};const S=function(s){if(!(!z()&&!s)){var r="ant-scrolling-effect",n=new RegExp("".concat(r),"g"),o=document.body.className;if(s){if(!n.test(o))return;p(b),b={},document.body.className=o.replace(n,"").trim();return}var e=k();if(e&&(b=p({position:"relative",width:"calc(100% - ".concat(e,"px)")}),!n.test(o))){var t="".concat(o," ").concat(r);document.body.className=t.trim()}}};var B=0,f=[],W="ant-scrolling-effect",w=new RegExp("".concat(W),"g"),y=new Map,I=$(function s(r){var n=this;T(this,s),this.lockTarget=void 0,this.options=void 0,this.getContainer=function(){var o;return(o=n.options)===null||o===void 0?void 0:o.container},this.reLock=function(o){var e=f.find(function(t){var i=t.target;return i===n.lockTarget});e&&n.unLock(),n.options=o,e&&(e.options=o,n.lock())},this.lock=function(){var o;if(!f.some(function(a){var c=a.target;return c===n.lockTarget})){if(f.some(function(a){var c,d=a.options;return(d==null?void 0:d.container)===((c=n.options)===null||c===void 0?void 0:c.container)})){f=[].concat(N(f),[{target:n.lockTarget,options:n.options}]);return}var e=0,t=((o=n.options)===null||o===void 0?void 0:o.container)||document.body;(t===document.body&&window.innerWidth-document.documentElement.clientWidth>0||t.scrollHeight>t.clientHeight)&&(e=k());var i=t.className;if(f.filter(function(a){var c,d=a.options;return(d==null?void 0:d.container)===((c=n.options)===null||c===void 0?void 0:c.container)}).length===0&&y.set(t,p({width:e!==0?"calc(100% - ".concat(e,"px)"):void 0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden"},{element:t})),!w.test(i)){var l="".concat(i," ").concat(W);t.className=l.trim()}f=[].concat(N(f),[{target:n.lockTarget,options:n.options}])}},this.unLock=function(){var o,e=f.find(function(l){var a=l.target;return a===n.lockTarget});if(f=f.filter(function(l){var a=l.target;return a!==n.lockTarget}),!(!e||f.some(function(l){var a,c=l.options;return(c==null?void 0:c.container)===((a=e.options)===null||a===void 0?void 0:a.container)}))){var t=((o=n.options)===null||o===void 0?void 0:o.container)||document.body,i=t.className;!w.test(i)||(p(y.get(t),{element:t}),y.delete(t),t.className=t.className.replace(w,"").trim())}},this.lockTarget=B++,this.options=r}),u=0,h=D(),g={},v=function(r){if(!h)return null;if(r){if(typeof r=="string")return document.querySelectorAll(r)[0];if(typeof r=="function")return r();if(H(r)==="object"&&r instanceof window.HTMLElement)return r}return document.body},A=function(s){R(n,s);var r=P(n);function n(o){var e;return T(this,n),e=r.call(this,o),e.container=void 0,e.componentRef=_.exports.createRef(),e.rafId=void 0,e.scrollLocker=void 0,e.renderComponent=void 0,e.updateScrollLocker=function(t){var i=t||{},l=i.visible,a=e.props,c=a.getContainer,d=a.visible;d&&d!==l&&h&&v(c)!==e.scrollLocker.getContainer()&&e.scrollLocker.reLock({container:v(c)})},e.updateOpenCount=function(t){var i=t||{},l=i.visible,a=i.getContainer,c=e.props,d=c.visible,m=c.getContainer;d!==l&&h&&v(m)===document.body&&(d&&!l?u+=1:t&&(u-=1));var x=typeof m=="function"&&typeof a=="function";(x?m.toString()!==a.toString():m!==a)&&e.removeCurrentContainer()},e.attachToParent=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(t||e.container&&!e.container.parentNode){var i=v(e.props.getContainer);return i?(i.appendChild(e.container),!0):!1}return!0},e.getContainer=function(){return h?(e.container||(e.container=document.createElement("div"),e.attachToParent(!0)),e.setWrapperClassName(),e.container):null},e.setWrapperClassName=function(){var t=e.props.wrapperClassName;e.container&&t&&t!==e.container.className&&(e.container.className=t)},e.removeCurrentContainer=function(){var t,i;(t=e.container)===null||t===void 0||(i=t.parentNode)===null||i===void 0||i.removeChild(e.container)},e.switchScrollingEffect=function(){u===1&&!Object.keys(g).length?(S(),g=p({overflow:"hidden",overflowX:"hidden",overflowY:"hidden"})):u||(p(g),g={},S(!0))},e.scrollLocker=new I({container:v(o.getContainer)}),e}return $(n,[{key:"componentDidMount",value:function(){var e=this;this.updateOpenCount(),this.attachToParent()||(this.rafId=E(function(){e.forceUpdate()}))}},{key:"componentDidUpdate",value:function(e){this.updateOpenCount(e),this.updateScrollLocker(e),this.setWrapperClassName(),this.attachToParent()}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.visible,i=e.getContainer;h&&v(i)===document.body&&(u=t&&u?u-1:u),this.removeCurrentContainer(),E.cancel(this.rafId)}},{key:"render",value:function(){var e=this.props,t=e.children,i=e.forceRender,l=e.visible,a=null,c={getOpenCount:function(){return u},getContainer:this.getContainer,switchScrollingEffect:this.switchScrollingEffect,scrollLocker:this.scrollLocker};return(i||l||this.componentRef.current)&&(a=O(U,{getContainer:this.getContainer,ref:this.componentRef,children:t(c)})),a}}]),n}(_.exports.Component);export{A as P,q as a,k as g};
